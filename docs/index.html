<!DOCTYPE html>
<html>

<head>
    <title>Embed Testing</title>
    
    <script type="text/javascript" src="https://public.tableau.com/javascripts/api/tableau-2.min.js"></script>
    <script type="text/javascript">
        <script type="text/javascript" src="https://public.tableau.com/javascripts/api/tableau-2.min.js"></script>
    <script type="text/javascript">
        var vizList = ["https://public.tableau.com/views/company_graphs/companycountriesbyfoundingyear?:language=en-US&:display_count=n&:origin=viz_share_link",
            "https://public.tableau.com/views/NumberofcompaniesinUSStates/companiesperstate?:language=en-US&:display_count=n&:origin=viz_share_link",
            "https://public.tableau.com/views/company_graphs_16288763389140/companytypesbyyearest_?:language=en-US&:retry=yes&:display_count=n&:origin=viz_share_link",
            "https://public.tableau.com/views/NumberofProductsforeachCompany/NumberofProductsbyCompany?:language=en-US&:display_count=n&:origin=viz_share_link",
            "https://public.tableau.com/views/NumberofSubcategoriesineachProductCategory/NumberofSubcategoriesbyCategory?:language=en-US&:display_count=n&:origin=viz_share_link",
            "https://public.tableau.com/views/ProductCountbySubcategoryandCategory/ProductCountbySubcategoryandCategory?:language=en-US&:display_count=n&:origin=viz_share_link"];
        
        var viz,
            vizLen = vizList.length,
            vizCount = 0;
        
        function createViz(vizPlusMinus) {
            var vizDiv = document.getElementById("vizContainer"),
                options = {
                    hideTabs: true
                };

            vizCount = vizCount + vizPlusMinus;
            
            if (vizCount >= vizLen) { 
            // Keep the vizCount in the bounds of the array index.
                vizCount = 0;
            }
            
            else if (vizCount < 0) {
                vizCount = vizLen - 1;
            }
            
            if (viz) { // If a viz object exists, delete it.
                viz.dispose();
            }

            var vizURL = vizList[vizCount];
            viz = new tableau.Viz(vizDiv, vizURL, options); 
        }
        
        function addPageNumber() {
            var pageNumberDiv = document.getElementById("numContainer");
            var vizNum = vizCount + 1;
            var pageNumber = document.createTextNode("Page " + vizNum + "of " + vizLen);
            pageNumberDiv.appendChild(pageNumber);
            document.body.insertBefore(pageNumberDiv, document.getElementById("content"));
        }
    </script>
</head>

<body onload="createViz(0); addPageNumber();">
    <div id="content">
        <div id="numContainer" style="width:150px; height:80px;"></div>
        <div id="vizContainer" style="width:800px; height:700px;"></div>
        <div id="controls" style="padding:20px;">
            <button style="width:100px;" onclick="javascript:createViz(-1); addPageNumber();">Previous</button>
            <button style="width:100px;" onclick="javascript:createViz(1); addPageNumber();">Next</button>
        </div> 
    </div>
</body>

</html>
